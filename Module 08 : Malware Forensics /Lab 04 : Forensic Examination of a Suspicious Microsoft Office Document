üéØ Objective
Perform static malware analysis on a suspicious Microsoft Word document to:
Detect embedded VBA macros
Extract hidden streams and code
Identify Indicators of Compromise (IoCs)
Determine malicious behavior without executing the file

üß∞ Tools Used
OleTools (oleid, oledump, olevba)
DidierStevensSuite
OffVis (Office Visualization Tool)
Python analysis environment

üìå Procedure (Key Steps)
üîç Step 1 ‚Äì Initial Document Triage (oleid)
Installed dependencies:
pip3 install -U olefile
pip3 install colorclass
apt-get install -y python3-pyparsing

Scanned document:
oleid.py Infected.docx

Results:
VBA macros detected
Multiple suspicious elements flagged
‚û° Indicates high-risk Office document.

üìÇ Step 2 ‚Äì Embedded Stream Analysis (oledump) 
oledump.py Infected.docx
Observations:
15 embedded streams detected
Stream #8 flagged with ‚ÄúM‚Äù indicating macro content
Dumped macro stream:
oledump.py -s 8 Infected.docx > stream8dump.txt
gedit stream8dump.txt
Findings:
Presence of URLDownloadToFileA
Indicates file downloads from external sources

üß¨ Step 3 ‚Äì Macro Extraction & Behavior Analysis (olevba)
Extract macro code:
olevba.py -c Infected.docx
Perform full analysis:
olevba.py -a Infected.docx

Suspicious VBA functions identified:
Function	Malicious Purpose
Auto_Open	Automatic execution
Environ	Reads system environment
URLDownloadToFileA	Downloads payload
Shell	Executes programs
Lib	Calls external DLL functions
‚û° Clear malicious execution chain confirmed.

üß™ Step 4 ‚Äì Hex & Keyword Inspection (OffVis)
Parser selected: WordBinaryFormatDetectionLogic
Reviewed Word binary content
Auto-execution triggers observed:
AutoOpen
Workbook_Open
URLDownloadToFileA
Payload behavior identified:
Download source:
http://germanya.com.ec/logs
Dropped files:
test.exe
counter.php
Renamed as:
sfjozjero.exe
lkjljlljk
Saved in: Temp directory

üîç Findings
Embedded malicious VBA macros present
Automatic execution on document open
External payload download functionality
Execution of dropped malware
Obfuscation through hidden streams
‚û° Confirmed malicious Word document used as an infection vector.

üìö Lessons Learned
Static analysis prevents malware execution
VBA macros remain a primary attack vector
Stream inspection exposes hidden behavior
Hex-level analysis validates obfuscation techniques
Office documents are still heavily used in phishing campaigns
