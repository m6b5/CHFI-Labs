ğŸ¯ Objective
Analyze a suspected Microsoft Word document using online threat intelligence platforms to:
Verify its malicious nature
Identify Indicators of Compromise (IoCs)
Observe runtime behavior
Correlate static and dynamic analysis results

ğŸ§° Tools Used
VirusTotal
Hybrid Analysis (Falcon Sandbox)

ğŸ“Œ Procedure (Key Steps)
ğŸ” Step 1 â€” File Reputation & Static Metadata (VirusTotal)
Uploaded the suspicious document to VirusTotal
Under the Detection tab:
Reviewed detection results across multiple antivirus engines

Under the Details tab:
Collected cryptographic hashes:
MD5
SHA-1
SHA-256
Vhash

Examined Basic Properties:
File type and size
Magic signature
Creation and print timestamps

âš ï¸ Observed timestamp inconsistencies (Last Printed: 2006 vs Created: 2009)
â¡ Indicates possible timestamp manipulation â€” a common malware evasion technique

ğŸŒ Step 2 â€” Network & Embedded Content Analysis (Relations Tab)
Reviewed:
ğŸ”— Contacted Domains:
germanya.com.ec
ğŸ“¦ Bundled Files:
Embedded VBA macro streams detected
High detection rates across AV engines
â¡ Confirms macro-based malicious payload delivery

âš™ï¸ Step 3 â€” Runtime Behavior Analysis (Behavior Tab)
ğŸ“ File System Actions:
Created files in the Temp directory
Dropped executable payloads

ğŸ§¾ Registry Activity:
Keys opened, created, modified, and deleted
Patterns consistent with persistence mechanisms

ğŸ”Œ Network & Services:
Enabled Windows services:
Rasman (remote/VPN networking)
SENS (System Event Notification Service)
â¡ Likely leveraged for network connectivity and payload retrieval

ğŸ” Step 4 â€” Mutex & Module Analysis
Observed:
Multiple malicious mutex objects (infection synchronization)
Typical malware execution control behavior
Loaded system modules included:
SETUPAPI.dll â†’ payload installation support
DNSAPI.dll â†’ domain resolution & communications
RASMAN.dll â†’ network connectivity management

ğŸ§ª Step 5 â€” Hybrid Analysis Sandbox Review
Reviewed high Threat Score
Confirmed malicious classification across engines

ğŸš© Malicious Indicators:
Auto-executing VBA macros
External command-and-control communication

âš ï¸ Suspicious Indicators:
Shellcode-like patterns
Abnormal system modifications

ğŸ” Process Inspection (WINWORD.EXE):
Accessed detailed runtime behavior via:
API Calls
Registry
Mutants (mutexes)
Handles
Modules
Files

Registry tab:
Displayed keys opened, created, and deleted

Files tab:
Observed file operations including:
FILE_READ_ATTRIBUTES, GENERIC_WRITE, GENERIC_READ, DELETE permissions

â¡ Indicates payload staging and execution activity

ğŸ” Findings
âœ” Embedded malicious VBA macros present
âœ” Automatic execution upon document opening
âœ” Communication with external malicious domain
âœ” Secondary payload download and execution
âœ” Manipulation of Windows services for persistence and networking
âœ” Mutex usage to control infection flow
â¡ Confirmed macro-based malware delivery document

ğŸ“š Lessons Learned
Online sandbox platforms rapidly validate suspicious samples
Metadata inconsistencies reveal potential anti-forensics techniques
Office macros remain a dominant malware delivery vector
Combining static and dynamic analysis provides full threat visibility
Threat intelligence platforms significantly accelerate forensic investigations
