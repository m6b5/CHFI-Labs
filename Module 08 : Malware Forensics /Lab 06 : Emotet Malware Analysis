ğŸ¯ Objective
Analyze how Emotet malware operates dynamically after execution by:
Inspecting malicious VBA macros
Monitoring network communications
Observing malicious process creation
Identifying persistence mechanisms
This lab demonstrates real-world malware infection chains used in phishing campaigns.

ğŸ§° Tools Used
Microsoft Word (VBA Macro Analysis)
Wireshark
Process Monitor (Sysinternals)

ğŸ“Œ Procedure (Key Steps)
ğŸ“§ Step 1 â€“ Analyzing Malicious Document Behavior
Opened Word document containing Emotet downloader
Observed Protected View enabled by default
Document used social engineering images prompting:
Enable Editing
Enable Content
â¡ This allows malicious VBA macros to execute.

ğŸ§¬ Step 2 â€“ Inspecting Obfuscated VBA Macros
Opened Macros via:
View â†’ Macros â†’ View Macros â†’ Edit
Findings:
Code executed via Document_Open() trigger
Heavy string fragmentation and junk variables
Presence of BASE64 encoding
Multiple useless modules used for obfuscation
â¡ Clear evidence of anti-analysis techniques.

ğŸŒ Step 3 â€“ Monitoring Payload Download (Wireshark)
Captured HTTP traffic showing GET request to:
177.185.192.135
Followed TCP Stream revealed:
Field	Value
Host	maisbrasilphoto.com.br
File downloaded	33096.exe
Encoding	Binary attachment
â¡ Emotet contacted external infrastructure to retrieve payload.

ğŸ–¥ Step 4 â€“ Observing Malicious Processes (Process Monitor)
Located parent process:
WINWORD.EXE
Child processes spawned:
PowerShell
Command Prompt
Downloaded executable

ğŸ” Step 5 â€“ Identifying Persistence Mechanism
Process Monitor revealed registry modification:
HKCU\Software\Microsoft\Windows\CurrentVersion\Run
Malware created autorun key using REG.exe
Ensures execution at every login
â¡ Classic Emotet persistence technique.

ğŸ” Findings
Emotet uses phishing documents with malicious macros
VBA code heavily obfuscated using Base64 and junk strings
Malware downloads binary payloads over HTTP
Legitimate Windows processes abused for execution
Registry Run keys used for persistence

ğŸ“š Lessons Learned
Office macros remain a major malware delivery vector
Obfuscation complicates static analysis
Network monitoring reveals payload infrastructure
Process trees expose infection chains
Registry analysis is critical for persistence detection
