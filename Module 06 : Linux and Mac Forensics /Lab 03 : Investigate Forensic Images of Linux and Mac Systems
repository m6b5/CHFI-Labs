ğŸ¯ Objective

A forensic image file is a bit-by-bit copy of a storage device containing:
Active files & folders
Deleted data
Slack space
Unallocated space

The objective of this lab is to:
Analyze forensic images from Linux and macOS systems and retrieve potential forensic artifacts
such as logs, deleted files, metadata, system configurations, and user activity.

ğŸ§° Tools Used

Autopsy (Digital Forensics Platform)
Spotlight Parser (macOS metadata extraction tool)
Ubuntu Forensics VM

ğŸ§ Part 1 â€“ Linux Forensic Image Analysis (linux.img)
ğŸ“Œ Key Analysis Steps
Loaded Linux_Evidence_001.img into Autopsy

Used default ingest modules to extract artifacts

Explored key directories:

ğŸ” Important Locations Reviewed
Directory	Forensic Value
/bin	Command binaries & potential log remnants
/boot	Bootloader files (malware persistence check)
/dev	Connected device information
/etc	System configuration files
/home	User activity & downloads
/var/log/apt	Software installation history
/cups	Printing activity
/tmp	Temporary attacker artifacts

ğŸ“‚ Notable Artifacts Identified
Recovered deleted files (red cross in Autopsy)
Syslog information embedded inside binaries
User login session traces
Package installation history (history.log)

Suspicious encrypted document:
Secret-encrypted.doc

Extension mismatches and metadata anomalies

ğŸ Part 2 â€“ macOS Forensic Image Analysis (MAC.dd)
ğŸ“Œ File System Event Logs (FSEvents)

Location:
.fseventsd/

Contains:
File creation
Deletions
Renames
Modifications

ğŸ“ Used to reconstruct user/system activity timeline.

ğŸ”¦ Spotlight Metadata Analysis
Spotlight stores system-wide metadata in:
.Spotlight-V100/Store-V2/.../.store.db

This database includes:
MAC timestamps
File access frequency
Logical file size
Last opened time
File paths

ğŸ§  Parsing Spotlight Database
âš™ï¸ Tool Setup
pip3 install lz4 pyliblzfse

â–¶ï¸ Execution
python3 spotlight_parser.py /home/store.db /home

ğŸ“„ Outputs Generated
spotlight-store_data.txt â†’ readable metadata
spotlight-store_fullpaths.tsv â†’ file paths + inode numbers (opened in LibreOffice Calc)

ğŸ” Findings
Linux System
âœ” Deleted files recovered
âœ” Evidence of software installation activity
âœ” Encrypted document detected
âœ” Log remnants inside binaries
âœ” User behavior traces in home directories

macOS System
âœ” File activity timeline from FSEvents
âœ” Metadata showing file usage history
âœ” Spotlight database revealing full file paths
âœ” Access patterns of user files & applications

ğŸ“š Lessons Learned
Forensic images contain far more than visible files
Deleted data can often be recovered
Logs are critical for reconstructing attacker actions
Metadata databases (Spotlight) reveal powerful timelines
Boot & configuration files help detect persistence techniques
Combining GUI tools (Autopsy) with CLI tools improves depth of analysis
