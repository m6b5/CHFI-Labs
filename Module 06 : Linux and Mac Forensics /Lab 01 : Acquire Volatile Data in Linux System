ğŸ¯ Objective
During active incidents, volatile system data provides crucial evidence that may disappear after shutdown or reboot.

This lab focuses on collecting and analyzing live Linux system artifacts to:

âœ” Identify suspicious activity
âœ” Trace attacker presence and movement
âœ” Determine impacted processes and network connections
âœ” Correlate user actions and persistence mechanisms

ğŸ§° Tools Used
Ubuntu Linux (Live System)
Built-in forensic utilities:

w, last, netstat, lsof, lsmod

auditd, aureport, ausearch

ps, ss, arp, nmap

.bash_history, /proc filesystem

xclip, Python scripts

ğŸ“Œ Procedure (Key Steps)
ğŸ•’ Step 1 â€” System Activity & Login History
w
last -a

Collected:
Current system uptime
Active user sessions
Historical login activity (potential unauthorized access)

ğŸŒ Step 2 â€” Network Connections & Open Ports
netstat
lsof > openfiles.txt
ss -l -p -n | grep PID
nmap -sT localhost
nmap -sU localhost


Analyzed:
Active connections
Listening services
Process-to-port mapping
Suspicious network exposure

ğŸ“ Step 3 â€” Open Files & Loaded Kernel Modules
lsmod
gedit openfiles.txt

Reviewed:
Loaded drivers/modules (potential rootkits)
Open files linked to processes and sockets

ğŸ“Š Step 4 â€” Audit Logs & User Activity Correlation
apt install -y auditd
aureport
id <user>
ausearch -ui <userID> --interpret

Captured:
Login attempts
Command execution
Privilege usage
User-based activity timeline

â± Step 5 â€” Persistence & Scheduled Tasks
ls /var/spool/cron/
ls /etc/cron.daily/

Reviewed:
Scheduled malicious jobs
Persistence mechanisms

ğŸ“œ Step 6 â€” Command History & System Artifacts
gedit .bash_history
arp
ps auxww
hostname

Analyzed:
Executed commands
Process listings
ARP cache (lateral movement)
Host identification

ğŸ“‚ Step 7 â€” Memory & Clipboard Evidence
apt install xclip
xclip

Captured:
Clipboard content (often abused during attacks)

ğŸ§ª Step 8 â€” Automated History Analysis
python3 history.py

Parsed:
User command sequences
Suspicious execution patterns

ğŸ” Findings
âœ” Active user sessions and historical logins collected
âœ” Open ports and network connections identified
âœ” Running processes correlated with ports and files
âœ” Audit logs revealed user activity timelines
âœ” Scheduled tasks checked for persistence
âœ” Command history reconstructed
âœ” Kernel modules verified for tampering

ğŸ“š Lessons Learned
Volatile data is critical for real-time incident response
Network artifacts reveal attacker communication paths
Audit logs provide precise activity timelines
Cron jobs are common persistence techniques
Process correlation exposes malicious execution chains
